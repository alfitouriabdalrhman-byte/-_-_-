<script type="module">
 import { questions } from "./questions.js";
 import { db } from "./firebase.js";
 import { doc, updateDoc, getDocs, collection }
 from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
 
 const correctSound = new Audio("./sounds/correct.mp3");
 const wrongSound = new Audio("./sounds/wrong.mp3");
 const tickSound = new Audio("./sounds/tick.mp3");
 
 let time = 15;
 let score = 0;
 let index = 0;
 
 // ðŸ”€ Ø§Ø®ØªÙŠØ§Ø± 25 Ø³Ø¤Ø§Ù„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
 const quiz = questions.sort(() => 0.5 - Math.random()).slice(0, 25);
 
 const q = document.getElementById("q");
 const ans = document.getElementById("answers");
 const timer = document.getElementById("timer");
 
 let myDoc;
 const snap = await getDocs(collection(db, "players"));
 myDoc = snap.docs[snap.docs.length - 1];
 
 function load() {
  time = 15;
  timer.innerText = time;
  q.style.opacity = 0;
  setTimeout(() => {
   q.innerText = quiz[index].q;
   q.style.opacity = 1;
  }, 300);
  
  ans.innerHTML = "";
  quiz[index].a.forEach((x, idx) => {
   let b = document.createElement("button");
   b.innerText = x;
   b.onclick = () => answer(idx);
   ans.appendChild(b);
  });
 }
 
 async function answer(idx) {
  if (idx === quiz[index].c) {
   correctSound.play();
   score += 100;
   if (time >= 10) score += 50;
  } else {
   wrongSound.play();
  }
  await updateDoc(doc(db, "players", myDoc.id), { score });
  index++;
  if (index === quiz.length) {
   location = "result.html";
  } else {
   load();
  }
 }
 
 setInterval(() => {
  time--;
  tickSound.play();
  timer.innerText = time;
  if (time === 0) answer(-1);
 }, 1000);
 
 load();
</script>